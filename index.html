<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Subdomain Vulnerabilities Report</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f7f7f7;
      color: #333;
      padding: 20px;
    }
    .container {
      max-width: 1000px;
      width: 90%;
      margin: 20px auto;
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }
    header {
      text-align: center;
      margin-bottom: 30px;
      border-bottom: 2px solid #007BFF;
      padding-bottom: 10px;
    }
    header h1 {
      font-size: 3em;
      color: #007BFF;
      margin-bottom: 5px;
    }
    header h2 {
      font-size: 1.5em;
      color: #555;
    }
    .summary {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-around;
      margin: 30px 0;
    }
    .summary-item {
      flex: 1 1 200px;
      background: #007BFF;
      color: #fff;
      padding: 15px;
      margin: 10px;
      border-radius: 8px;
      text-align: center;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    .summary-item:hover {
      background: #0056b3;
    }
    .summary-item h3 {
      font-size: 1.2em;
      margin-bottom: 10px;
    }
    .summary-item p {
      font-size: 1.5em;
      margin: 0;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }
    table thead {
      background: #007BFF;
      color: #fff;
    }
    table th, table td {
      padding: 12px;
      border: 1px solid #ddd;
      text-align: left;
    }
    table tbody tr:nth-child(even) {
      background: #f2f2f2;
    }
    .screenshot {
      max-width: 100%;
      height: auto;
      margin-top: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
    .footer {
      text-align: center;
      color: #777;
      font-size: 1em;
      margin-top: 20px;
    }
    .developer {
      text-align: center;
      margin-top: 10px;
      font-size: 1.2em;
      color: #007BFF;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Subdomain Vulnerabilities Report</h1>
      <h2>Developed by: Mohamed Fouad</h2>
    </header>

    <!-- قسم الملخص -->
    <div class="summary">
      <div class="summary-item" onclick="filterTable('all')">
        <h3>Total Vulnerabilities</h3>
        <p id="totalVuln">0</p>
      </div>
      <div class="summary-item" onclick="filterTable('takeover')">
        <h3>Subdomain Takeover</h3>
        <p id="takeoverCount">0</p>
      </div>
      <div class="summary-item" onclick="filterTable('xss')">
        <h3>Potential XSS</h3>
        <p id="xssCount">0</p>
      </div>
      <div class="summary-item" onclick="filterTable('dns')">
        <h3>DNS Misconfiguration</h3>
        <p id="dnsCount">0</p>
      </div>
      <div class="summary-item" onclick="filterTable('sql')">
        <h3>SQL Injection</h3>
        <p id="sqlCount">0</p>
      </div>
    </div>

    <!-- جدول النتائج -->
    <table id="resultsTable">
      <thead>
        <tr>
          <th>URL</th>
          <th>Vulnerability Details</th>
          <th>Screenshot</th>
        </tr>
      </thead>
      <tbody>
        {{RESULTS}}
      </tbody>
    </table>

    <!-- اسم المبرمج -->
    <div class="developer">
      <p>Report generated by: <strong>Mohamed Fouad</strong></p>
    </div>

    <!-- تذييل الصفحة -->
    <div class="footer">
      <p>Report generated on: <span id="reportDate"></span></p>
    </div>
  </div>

  <script>
    // تعيين تاريخ التقرير الحالي
    document.getElementById('reportDate').textContent = new Date().toLocaleString();

    // دالة لحساب عدد الثغرات من صفوف الجدول وتحديث الملخص
    function calculateSummary() {
      let total = 0, takeover = 0, xss = 0, dns = 0, sql = 0;
      const table = document.getElementById('resultsTable');
      const rows = table.getElementsByTagName('tr');

      // تجاهل صف الرأس، نبدأ من الصف الأول في tbody
      for (let i = 1; i < rows.length; i++) {
        const row = rows[i];
        // الخانة الثانية تحتوي على تفاصيل الثغرة
        const vulnText = row.cells[1].innerText.toLowerCase();
        if (vulnText.trim() === "") continue;
        total++;
        if (vulnText.includes("subdomain takeover vulnerability")) takeover++;
        if (vulnText.includes("potential xss vulnerability")) xss++;
        if (vulnText.includes("dns misconfiguration")) dns++;
        if (vulnText.includes("sql injection vulnerability")) sql++;
      }

      document.getElementById('totalVuln').textContent = total;
      document.getElementById('takeoverCount').textContent = takeover;
      document.getElementById('xssCount').textContent = xss;
      document.getElementById('dnsCount').textContent = dns;
      document.getElementById('sqlCount').textContent = sql;
    }

    // دالة لتصفية الجدول حسب نوع الثغرة
    function filterTable(type) {
      const rows = document.querySelectorAll("#resultsTable tbody tr");
      rows.forEach(row => {
        const vulnText = row.cells[1].innerText.toLowerCase();
        if (type === 'all' || vulnText.includes(type)) {
          row.style.display = '';
        } else {
          row.style.display = 'none';
        }
      });
    }

    
    window.addEventListener('load', calculateSummary);
  </script>
</body>
</html>
